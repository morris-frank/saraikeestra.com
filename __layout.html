<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1">
    <meta name="theme-color"
          content="oklch(40% 42% 29deg)">
    <meta name="description"
          name="The personal website of Sarai Keestra.">

    <script type='text/javascript'
            src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>
    <script async
            src="https://badge.dimensions.ai/badge.js"
            charset="utf-8"></script>

    <title>Sarai Keestra - Publications</title>
</head>

<body>
    <main>
    </main>

    <footer>
        <p>
            &copy; 2025 Sarai Keestra
        </p>
    </footer>

    <script>
        function toggleAbstract(button) {
            const abstractContainer = button.parentElement;
            const abstract = abstractContainer.querySelector('.abstract');
            const fullText = abstract.getAttribute('data-full-text');

            if (abstract.classList.contains('expanded')) {
                // Collapse
                abstract.textContent = fullText.substring(0, 200) + '...';
                abstract.classList.remove('expanded');
                abstract.classList.add('truncated');
                button.textContent = 'Show more';
            } else {
                // Expand
                abstract.textContent = fullText;
                abstract.classList.add('expanded');
                abstract.classList.remove('truncated');
                button.textContent = 'Show less';
            }
        }

        // Auto-detect if abstracts need truncation on page load
        document.addEventListener('DOMContentLoaded', function () {
            const abstracts = document.querySelectorAll('.abstract');
            abstracts.forEach(abstract => {
                const fullText = abstract.getAttribute('data-full-text');
                if (fullText && fullText.length > 200) {
                    const button = abstract.parentElement.querySelector('.abstract-toggle');
                    if (button) {
                        button.style.display = 'block';
                    }
                }
            });

            // Function to reorder references by dimensions score
            function reorderReferences() {
                const references = document.querySelectorAll('.reference.with-score')
                let allScoresFound = true;
                references.forEach(ref => {
                    const scoreElement = ref.querySelector('.__dimensions_badge_embed__ .__db_score');
                    if (!scoreElement) {
                        allScoresFound = false;
                        return;
                    }
                    const score = 200 - parseFloat(scoreElement.textContent);
                    ref.style.order = score;
                });

                // If not all scores were found, try again in 500ms
                if (!allScoresFound) {
                    setTimeout(reorderReferences, 500);
                }
            }

            // Start trying to reorder once initial page load is done
            reorderReferences();

            // Topic filtering functionality
            const topicFilters = document.querySelectorAll('.topic-filter');
            const references = document.querySelectorAll('.reference');
            topicFilters.forEach(filter => {
                filter.addEventListener('click', function () {
                    const filtersAllActive = Array.from(topicFilters).every(f => f.classList.contains('active'));

                    let topics = [];
                    if (filtersAllActive || !this.classList.contains('selected')) {
                        topicFilters.forEach(f => f.classList.remove('active', 'selected'));
                        this.classList.add('selected');
                        topics = [this.getAttribute('data-topic')];
                    } else {
                        topicFilters.forEach(f => f.classList.remove('selected'));
                        topicFilters.forEach(f => f.classList.add('active'));
                        topics = Array.from(topicFilters).map(f => f.getAttribute('data-topic'));
                    }

                    // Show/hide references based on active filters
                    references.forEach(ref => {
                        const refTopic = ref.getAttribute('data-topic');
                        if (topics.length === 0 || topics.includes(refTopic)) {
                            ref.classList.remove('hidden');
                        } else {
                            ref.classList.add('hidden');
                        }
                    });
                });
            });
        });
    </script>
</body>

</html>